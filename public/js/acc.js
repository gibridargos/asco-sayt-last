// accounting.js — To'liq 3 tilga mos versiya (Senera)
const accountingTranslations = {
    uz: {
        accountingPageTitle: "Buxgalteriya hisobini olib borish - Senera",
        accountingTitle: "Buxgalteriya hisobini olib borish",
        accountingIntro: "Professional buxgalteriya xizmatlarimiz sizning biznesingizni soliq va hisobot masalalarida yengillashtiradi.",
        pricingTitle: "Pulningizni tejash yordam beramiz!",
        bronzeTitle: "Bronze",
        bronzePrice: "2 500 000 sum",
        bronzeDesc1: "Asosiy hisobotlar",
        bronzeDesc2: "Soliq maslahati",
        bronzeDesc3: "Oylik hisob-kitob",
        silverTitle: "Silver",
        silverPrice: "3 500 000 sum",
        silverDesc1: "Kengaytirilgan hisobotlar",
        silverDesc2: "Soliq optimallashtirish",
        silverDesc3: "Oylik va choraklik hisob-kitob",
        goldTitle: "Gold",
        goldPrice: "4 500 000 sum",
        goldDesc1: "To'liq buxgalteriya",
        goldDesc2: "Soliq va audit yordami",
        goldDesc3: "Yillik hisob-kitob va maslahat",
        platinumTitle: "Platinum",
        platinumPrice: "6 000 000 sum",
        platinumDesc1: "VIP buxgalteriya",
        platinumDesc2: "To'liq maslahat va optimizatsiya",
        platinumDesc3: "Kunlik monitoring",
        calculatorTitle: "Ish yuritish sohasi kalkulyatori",
        topSectionLabel: "Ish yuritish sohasi",
        xizmatlarLabel: "Xizmatlar",
        savdoLabel: "Savdo",
        ishlabChiqarishLabel: "Ishlab chiqarish",
        importEksportLabel: "Import-eksport",
        employeesLabel: "Xodimlar soni",
        documentsLabel: "Xujjatlar soni",
        bottomSectionLabel: "Ish yuritish sohasi",
        ruxsatSoliqLabel: "Ruxsat etilgan soliq",
        savdoSogiLabel: "Savdo so'gi",
        oosTolovchiLabel: "OOS to'lovchi",
        estimateBtn: "Xarajatlarni smetasi olish",
        resultText: "Sizning hisobingizga ko'ra xizmat narxi 6,600,000 so'mgacha bo'ladi.",
        consultBtn: "Konsultatsiya olish",
        formTitle: "Ariza yuborish",
        firstNameLabel: "Ism",
        lastNameLabel: "Familiya",
        phoneLabel: "Telefon raqami",
        descriptionLabel: "Ish tavsifi",
        submitBtn: "Tasdiqlash"
    },

    ru: {
        accountingPageTitle: "Ведение бухгалтерского учета - Senera",
        accountingTitle: "Ведение бухгалтерского учета",
        accountingIntro: "Наши профессиональные бухгалтерские услуги облегчают ваш бизнес в вопросах налогов и отчетности.",
        pricingTitle: "Поможем сэкономить ваши деньги!",
        bronzeTitle: "Бронза",
        bronzePrice: "2 500 000 сум",
        bronzeDesc1: "Основные отчеты",
        bronzeDesc2: "Налоговые консультации",
        bronzeDesc3: "Ежемесячный расчет",
        silverTitle: "Серебро",
        silverPrice: "3 500 000 сум",
        silverDesc1: "Расширенные отчеты",
        silverDesc2: "Оптимизация налогов",
        silverDesc3: "Ежемесячный и ежеквартальный расчет",
        goldTitle: "Золото",
        goldPrice: "4 500 000 сум",
        goldDesc1: "Полная бухгалтерия",
        goldDesc2: "Помощь с налогами и аудитом",
        goldDesc3: "Годовой расчет и консультация",
        platinumTitle: "Платина",
        platinumPrice: "6 000 000 сум",
        platinumDesc1: "VIP бухгалтерия",
        platinumDesc2: "Полная консультация и оптимизация",
        platinumDesc3: "Ежедневный мониторинг",
        calculatorTitle: "Калькулятор сферы деятельности",
        topSectionLabel: "Сфера деятельности",
        xizmatlarLabel: "Услуги",
        savdoLabel: "Торговля",
        ishlabChiqarishLabel: "Производство",
        importEksportLabel: "Импорт-экспорт",
        employeesLabel: "Количество сотрудников",
        documentsLabel: "Количество документов",
        bottomSectionLabel: "Сфера деятельности",
        ruxsatSoliqLabel: "Разрешенный налог",
        savdoSogiLabel: "Торговый сбор",
        oosTolovchiLabel: "Плательщик ООС",
        estimateBtn: "Получить смету расходов",
        resultText: "По вашему расчету стоимость услуги до 6,600,000 сум.",
        consultBtn: "Получить консультацию",
        formTitle: "Отправить заявку",
        firstNameLabel: "Имя",
        lastNameLabel: "Фамилия",
        phoneLabel: "Номер телефона",
        descriptionLabel: "Описание работы",
        submitBtn: "Подтвердить"
    },

    en: {
        accountingPageTitle: "Accounting Services - Senera",
        accountingTitle: "Accounting Services",
        accountingIntro: "Our professional accounting services simplify your business in tax and reporting matters.",
        pricingTitle: "We help you save money!",
        bronzeTitle: "Bronze",
        bronzePrice: "2,500,000 UZS",
        bronzeDesc1: "Basic reports",
        bronzeDesc2: "Tax advice",
        bronzeDesc3: "Monthly calculation",
        silverTitle: "Silver",
        silverPrice: "3,500,000 UZS",
        silverDesc1: "Extended reports",
        silverDesc2: "Tax optimization",
        silverDesc3: "Monthly and quarterly calculation",
        goldTitle: "Gold",
        goldPrice: "4,500,000 UZS",
        goldDesc1: "Full accounting",
        goldDesc2: "Tax and audit assistance",
        goldDesc3: "Annual calculation and consultation",
        platinumTitle: "Platinum",
        platinumPrice: "6,000,000 UZS",
        platinumDesc1: "VIP accounting",
        platinumDesc2: "Full consultation and optimization",
        platinumDesc3: "Daily monitoring",
        calculatorTitle: "Business Activity Calculator",
        topSectionLabel: "Field of activity",
        xizmatlarLabel: "Services",
        savdoLabel: "Trade",
        ishlabChiqarishLabel: "Manufacturing",
        importEksportLabel: "Import-export",
        employeesLabel: "Number of employees",
        documentsLabel: "Number of documents",
        bottomSectionLabel: "Field of activity",
        ruxsatSoliqLabel: "Permitted tax",
        savdoSogiLabel: "Trade fee",
        oosTolovchiLabel: "OOS payer",
        estimateBtn: "Get expense estimate",
        resultText: "According to your calculation, the service cost is up to 6,600,000 UZS.",
        consultBtn: "Get consultation",
        formTitle: "Submit application",
        firstNameLabel: "First name",
        lastNameLabel: "Last name",
        phoneLabel: "Phone number",
        descriptionLabel: "Job description",
        submitBtn: "Confirm"
    }
};

function updateAccountingLanguage(lang) {
    document.querySelectorAll('[data-lang]').forEach(el => {
        const key = el.getAttribute('data-lang');
        const text = accountingTranslations[lang]?.[key] || accountingTranslations.uz[key];
        if (text) {
            el.innerHTML = text;
        }
    });

    const pageTitle = accountingTranslations[lang]?.accountingPageTitle || accountingTranslations.uz.accountingPageTitle;
    if (pageTitle) {
        document.title = pageTitle;
    }

    document.documentElement.lang = lang;
}

document.addEventListener('DOMContentLoaded', () => {
    const langSelect = document.getElementById('languageSelect');
    if (langSelect) {
        const savedLang = localStorage.getItem('selectedLanguage') || 'uz';
        langSelect.value = savedLang;
        updateAccountingLanguage(savedLang);

        langSelect.addEventListener('change', (e) => {
            const newLang = e.target.value;
            localStorage.setItem('selectedLanguage', newLang);
            updateAccountingLanguage(newLang);
        });
    } else {
        updateAccountingLanguage('uz');
    }

    // Top checkboxes — max 3 ta
    document.querySelectorAll('[data-category="top"]').forEach(cb => {
        cb.addEventListener('change', () => {
            const checked = document.querySelectorAll('[data-category="top"]:checked').length;
            if (checked > 3) {
                cb.checked = false;
                alert('Yuqoridagi sohadan faqat 3 tasini tanlashingiz mumkin!');
            }
        });
    });

    // Xarajatlarni smetasi olish
    const estimateBtn = document.getElementById('estimateBtn');
    const resultSection = document.getElementById('resultSection');
    const resultText = document.getElementById('resultText');

    if (estimateBtn) {
        estimateBtn.addEventListener('click', () => {
            resultText.innerText = accountingTranslations[localStorage.getItem('selectedLanguage') || 'uz'].resultText;
            resultSection.classList.remove('d-none');
            resultSection.scrollIntoView({ behavior: 'smooth' });
        });
    }

    // Konsultatsiya olish
    const consultBtn = document.getElementById('consultBtn');
    const formSection = document.getElementById('formSection');

    if (consultBtn) {
        consultBtn.addEventListener('click', () => {
            formSection.classList.remove('d-none');
            formSection.scrollIntoView({ behavior: 'smooth' });
        });
    }

    // Form yuborish — Telegramga
    const consultForm = document.getElementById('consultForm');
    if (consultForm) {
        consultForm.addEventListener('submit', (e) => {
            e.preventDefault();

            const firstName = document.getElementById('firstName').value.trim();
            const lastName = document.getElementById('lastName').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const description = document.getElementById('description').value.trim();
            const totalCost = "6,600,000";

            if (!firstName || !lastName || !phone || !description) {
                alert('Iltimos, barcha maydonlarni to\'ldiring!');
                return;
            }

            const message = `Yangi user:\nFIO: ${firstName} ${lastName}\nTelefon raqami: ${phone}\nIsh tavsifi: ${description}\nXarajati: ${totalCost} so'm`;

            const BOT_TOKEN = '7969492138:AAFNPsiRGOC0JPCQYgNpEbzdbj6vOHwldrM'; // O'zgartiring
            const CHAT_ID = '-4897674974';     // O'zgartiring

            fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    chat_id: CHAT_ID,
                    text: message
                })
            })
            .then(res => res.json())
            .then(data => {
                if (data.ok) {
                    alert('Ariza muvaffaqiyatli yuborildi!');
                    consultForm.reset();
                    formSection.classList.add('d-none');
                    resultSection.classList.add('d-none');
                } else {
                    alert('Xatolik yuz berdi.');
                }
            })
            .catch(() => alert('Internet aloqasi muammosi.'));
        });
    }
});